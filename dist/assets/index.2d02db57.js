import{_ as S,d as q,r as I,u as z,a as x,c as J,b as K,e as m,o as R,f as O,g as T,h as l,i as r,w as n,j as t,E as p,k as F,l as U,m as W,t as Q,n as $,p as C,q as j,s as P,v as G,x as H,y as L,z as X,A as Y}from"./index.6d0f2da3.js";import{m as Z}from"./md5.2f2de61d.js";const g=c=>(L("data-v-760960fe"),c=c(),X(),c),ee={key:0,class:"login"},se={class:"login-main"},oe=g(()=>l("div",{class:"login-title"},[l("img",{class:"login-logo",src:Y})],-1)),ue={class:"login-box"},ae=g(()=>l("p",{class:"login-text"}," \u7528\u6237\u767B\u5F55 ",-1)),te=g(()=>l("i",{class:"iconfont icon-zhanghao"},null,-1)),re=g(()=>l("i",{class:"iconfont icon-mima"},null,-1)),ne=["src"],le=q({__name:"index",setup(c){var B;const V=(B=I.find(s=>{var e;return(e=s.meta)==null?void 0:e.auth}))==null?void 0:B.children,b=z(),a=x({userName:"",password:"",vcodeKey:"",vcodeValue:""});function D(s){let e="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",o=e.length,u="";for(let v=0;v<s;v++)u+=e.charAt(Math.floor(Math.random()*o));return u}const f=()=>{a.vcodeKey=D(16)};f();const k=J(()=>`http://ybgyy.xxsncloud.com//ips/image/code?width=70&height=33&codeCount=4&lineCount=1&key=${a.vcodeKey}`),E=K();m(!1);const d=m(!1),h=m(),N=x({userName:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D",trigger:"blur"}],password:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801",trigger:"blur"},{required:!0,message:"\u8BF7\u8F93\u51656-20\u4F4D\u5B57\u6BCD+\u6570\u5B57\u7684\u5BC6\u7801",trigger:"blur"}],vcodeValue:[{required:!0,message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",trigger:"blur"}]}),_=async s=>{!s||await s.validate((e,o)=>{e?(console.log("submit!"),A()):console.log("error submit!",o)})},A=async()=>{try{d.value=!0;const s=m(Z(a.password).substr(8,16)),e=await j({...a,password:s.value});P.set("token",e.token);debugger;const o=G(e.menu),u=y(V,o);b.setMenu(u),d.value=!1,u.length?E.push(u[0].path):H.error("\u60A8\u6CA1\u6709\u7CFB\u7EDF\u64CD\u4F5C\u6743\u9650\uFF0C\u8BF7\u8054\u7CFB\u7BA1\u7406\u5458\uFF01")}catch{f(),d.value=!1}},y=(s,e)=>{let o=[];debugger;return s==null||s.forEach(u=>{if(Array.isArray(u.meta.id)){if(u.meta.id.some(i=>e.includes(i))){let i=JSON.parse(JSON.stringify(u));i.children&&i.children.length&&(i.children=y(i.children,e)),o.push(i)}}else if(e.includes(u.meta.id)){let w=JSON.parse(JSON.stringify(u));o.push(w)}}),o},M=s=>{s.keyCode===13&&_(h.value)};return R(()=>{window.addEventListener("keydown",M)}),(s,e)=>s.isFromThirdPlatform?C("v-if",!0):(O(),T("div",ee,[l("div",se,[oe,l("div",ue,[ae,r(t($),{ref_key:"formDataRef",ref:h,model:a,rules:N},{default:n(()=>[r(t(p),{label:"",prop:"userName"},{default:n(()=>[r(t(F),{modelValue:a.userName,"onUpdate:modelValue":e[0]||(e[0]=o=>a.userName=o),size:"large",placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7/\u624B\u673A\u53F7",maxlength:"20"},{prefix:n(()=>[te]),_:1},8,["modelValue"])]),_:1}),r(t(p),{label:"",prop:"password"},{default:n(()=>[r(t(F),{modelValue:a.password,"onUpdate:modelValue":e[1]||(e[1]=o=>a.password=o),type:"password",size:"large",placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",maxlength:"20"},{prefix:n(()=>[re]),suffix:n(()=>[l("img",{style:{cursor:"pointer"},class:"password-img",src:t(k),onClick:f},null,8,ne)]),_:1},8,["modelValue"])]),_:1}),r(t(p),{label:"",prop:"vcodeValue"},{default:n(()=>[r(t(F),{modelValue:a.vcodeValue,"onUpdate:modelValue":e[2]||(e[2]=o=>a.vcodeValue=o),type:"text",size:"large",placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",maxlength:"20"},null,8,["modelValue"])]),_:1}),r(t(p),null,{default:n(()=>[r(t(U),{color:"#4371EE",loading:d.value,onClick:e[3]||(e[3]=o=>_(h.value))},{default:n(()=>[W(Q(d.value?"\u767B\u5F55\u4E2D":"\u767B\u5F55"),1)]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"]),C(` <div class="login-other">
                    <p>\u4F7F\u7528\u5176\u4ED6\u65B9\u5F0F\u767B\u5F55</p>
                    <div class="login-method">
                        <i
                            class="iconfont icon-weixin"
                            @mouseenter="showWeixin = true"
                            @mouseleave="showWeixin = false"
                        ></i>
                        <i id="qqLogin" class="iconfont icon-qq"></i>
                        <div v-if="showWeixin" class="wx-code">
                            <Qrcode></Qrcode>
                        </div>
                    </div>
                </div> `)])])]))}});var ce=S(le,[["__scopeId","data-v-760960fe"]]);export{ce as default};
