import{_ as $,d as j,a as y,b as k,N as S,g as d,h as U,i as z,j as m,k as n,w as o,l as K,I as W,p as w,A as b,L}from"./index.37c16388.js";import"./dayjs.452bfdbe.js";const q=[[104.054352,30.58249],[104.055085,30.582357],[104.05601,30.582397],[104.056781,30.582397],[104.057822,30.582457],[104.058863,30.58249],[104.059827,30.58249],[104.060058,30.582125],[104.059981,30.580864],[104.060058,30.580731],[104.059981,30.580233],[104.06002,30.579801],[104.059981,30.579038],[104.06002,30.578773],[104.060482,30.578673],[104.060868,30.578738],[104.061178,30.578759],[104.06156,30.578749],[104.062026,30.578769],[104.062026,30.578769],[104.062312,30.578471],[104.062336,30.578327],[104.0623,30.578143],[104.062276,30.578009],[104.062336,30.577855],[104.062384,30.57766],[104.062324,30.5773],[104.062563,30.577249],[104.062837,30.577238],[104.063052,30.577228],[104.063314,30.577269],[104.063446,30.577279],[104.06384,30.577269],[104.064114,30.577259],[104.06446,30.5773],[104.064997,30.57731],[104.063493,30.57729],[104.06378,30.577259],[104.064281,30.577238],[104.064341,30.57693],[104.064293,30.576529],[104.064317,30.576129],[104.064377,30.575892],[104.064365,30.575656],[104.065021,30.575338]],G=()=>q.reverse(),H=[{id:"1",label:"\u8F66\u961F1",children:[{id:"1-1",label:"\u5DDDA12345"},{id:"1-2",label:"\u5DDDB67890"},{id:"1-3",label:"\u5DDDC54321"}]},{id:"2",label:"\u8F66\u961F2",children:[{id:"2-1",label:"\u5DDDD98765"},{id:"2-2",label:"\u5DDDE43210"}]}];const J={class:"main-content"},O={class:"flex-box",id:"mapParentContainer",style:{height:"100%"}},Q={class:"left-box"},X={class:"map-layout"},Z={class:"tool-box"},ee={class:"input-item"},te={class:"input-item"},ne=j({__name:"list",setup(oe){const _=y(null);k({});let r=[],c=null;const a=k({beginDate:"",carNumber:"",endDate:""});y([]);const p=y(200),E=k({100:"0.5\u500D",200:"\u6B63\u5E38",300:"2\u500D",400:"4\u500D",500:"8\u500D"}),h={100:2e3,200:1e3,300:500,400:250,500:125},v=y([]);(()=>{v.value=H})();const C=({height:t})=>{const e=document.getElementById("mapParentContainer");e.style.height=t+"px"},P=t=>{c=t},A=t=>{window.polyline&&window.polyline.setMap(null),window.passedPolyline&&window.passedPolyline.setMap(null),window.polyline=new AMap.Polyline({map:c,path:t,showDir:!0,strokeColor:"#28F",strokeWeight:6}),window.passedPolyline=new AMap.Polyline({map:c,strokeColor:"#AF5",strokeWeight:6}),window.marker=new AMap.Marker({map:c,position:t[0],icon:"https://a.amap.com/jsapi_demos/static/demo-center-v2/car.png",offset:new AMap.Pixel(-13,-26)}),window.marker.on("moving",function(e){console.log(M(t,e.target.getPosition())),window.passedPolyline.setPath(e.passedPath),c.setCenter(e.target.getPosition(),!0)}),c.setFitView()},B=function(){if(window.marker.stopMove(),!r||r.length===0){b.error("\u8BF7\u5148\u67E5\u8BE2\u6709\u6548\u8F68\u8FF9\u6570\u636E");return}window.marker.moveAlong(r,{duration:h[p.value],autoRotation:!0})},x=function(){window.marker.pauseMove()},N=function(){window.marker.resumeMove()},F=()=>{window.marker&&window.marker.stopMove&&window.marker.stopMove(),window.polyline&&(window.polyline.setMap(null),window.polyline=null),window.passedPolyline&&(window.passedPolyline.setMap(null),window.passedPolyline=null),window.marker&&(window.marker.setMap(null),window.marker=null)},V=()=>{a.beginDate="",a.endDate="",a.carNumber="",F(),r=[],_.value&&_.value.setCurrentKey&&_.value.setCurrentKey(null)},Y=async()=>{const t={beginDate:a.beginDate,endDate:a.endDate||L().format("YYYY-MM-DD"),carNumber:a.carNumber};try{r=await G(t),F(),A(r)}catch{b.error("\u8F68\u8FF9\u6570\u636E\u67E5\u8BE2\u5931\u8D25")}},I=t=>{const e=!(t.children&&t.children.length);a.carNumber=e?t.label:""};S(p,t=>{});const R=()=>{if(console.log(1),window.marker){console.log(window.marker);const t=window.marker.getPosition();console.log(t);const e=M(r,t);if(console.log(e),e!==-1&&e<r.length-4){const s=r.slice(e);window.marker.stopMove(),window.marker.setPosition(s[0]),window.marker.moveAlong(s,{duration:h[p.value],autoRotation:!0})}}};function M(t,e){if(!Array.isArray(t)||t.length===0||!(e!=null&&e.lng)||!(e!=null&&e.lat))return 0;let s=1/0,i=0;for(let l=0;l<t.length;l++){const[D,f]=t[l],g=Math.abs(D-e.lng)+Math.abs(f-e.lat);g<s&&(s=g,i=l)}return i}return(t,e)=>{const s=d("el-date-picker"),i=d("el-form-item"),l=d("el-button"),D=d("el-form"),f=d("el-card"),g=d("el-slider"),T=d("MyMap");return U(),z("div",J,[m("section",O,[m("section",Q,[n(f,{header:"\u6761\u4EF6\u67E5\u8BE2",class:"tree-card"},{default:o(()=>[n(D,{"label-position":"top",model:a},{default:o(()=>[n(i,{label:"\u5F00\u59CB\u65E5\u671F\uFF1A"},{default:o(()=>[n(s,{modelValue:a.beginDate,"onUpdate:modelValue":e[0]||(e[0]=u=>a.beginDate=u),type:"date",format:"YYYY-MM-DD",placeholder:"\u5F00\u59CB\u65E5\u671F"},null,8,["modelValue"])]),_:1}),n(i,{label:"\u7ED3\u675F\u65E5\u671F\uFF1A"},{default:o(()=>[n(s,{modelValue:a.endDate,"onUpdate:modelValue":e[1]||(e[1]=u=>a.endDate=u),type:"date",format:"YYYY-MM-DD",placeholder:"\u5F00\u59CB\u65E5\u671F"},null,8,["modelValue"])]),_:1}),n(i,{label:"\u9009\u62E9\u8F66\u8F86\uFF1A"},{default:o(()=>[n(K(W),{ref_key:"treeRef",ref:_,"highlight-current":!0,"node-key":"id",data:v.value,onNodeClick:I},null,8,["data"])]),_:1}),n(i,{style:{"text-align":"center"}},{default:o(()=>[n(l,{type:"primary",onClick:Y},{default:o(()=>[w("\u67E5 \u8BE2")]),_:1}),n(l,{onClick:V},{default:o(()=>[w("\u91CD \u7F6E")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),n(f,{header:"\u56DE\u653E\u901F\u5EA6",class:"bottom-card"},{default:o(()=>[n(g,{modelValue:p.value,"onUpdate:modelValue":e[2]||(e[2]=u=>p.value=u),min:100,max:500,"show-tooltip":!1,step:100,marks:E,onChange:R},null,8,["modelValue","marks"])]),_:1})]),m("div",X,[n(T,{onInit:P,onResize:C},{default:o(()=>[m("section",Z,[m("div",ee,[n(l,{value:"",type:"primary",id:"start",onClick:e[3]||(e[3]=u=>B())},{default:o(()=>[w("\u5F00\u59CB\u52A8\u753B")]),_:1}),n(l,{value:"",type:"primary",id:"pause",onClick:e[4]||(e[4]=u=>x())},{default:o(()=>[w("\u6682\u505C\u52A8\u753B")]),_:1})]),m("div",te,[n(l,{value:"",type:"primary",id:"resume",onClick:e[5]||(e[5]=u=>N())},{default:o(()=>[w("\u7EE7\u7EED\u52A8\u753B")]),_:1})])])]),_:1})])])])}}});var se=$(ne,[["__scopeId","data-v-7a555822"]]);export{se as default};
//# sourceMappingURL=list.4d3ad16b.js.map
