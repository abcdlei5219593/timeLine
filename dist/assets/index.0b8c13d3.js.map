{"version":3,"file":"index.0b8c13d3.js","sources":["../../src/helper/index.ts"],"sourcesContent":["import dayjs from './dayjs';\r\nimport Cookie from 'js-cookie';\r\n\r\nexport const setToken = (token: string): void => {\r\n    Cookie.set(\r\n        'token',\r\n        token,\r\n        {\r\n            expires: new Date(new Date().getTime() + 120 * 60 * 1000)\r\n        }\r\n    );\r\n};\r\n\r\n\r\nexport const getColrByApi = (aqiVal: number): string | undefined => {\r\n    if (aqiVal >= 0 && aqiVal < 20) {\r\n        return 'background-color:green';\r\n    } else if (aqiVal >= 20 && aqiVal < 100) {\r\n        const bili = (aqiVal - 20) / 100 * 100;\r\n        const one = (255 + 255) / 100;\r\n        let r = 0;\r\n        let g = 0;\r\n        let b = 0;\r\n        if (bili < 50) {\r\n            // 比例小于50的时候红色是越来越多的,直到红色为255时(红+绿)变为黄色.\r\n            r = one * bili;\r\n            g = 128;\r\n        }\r\n        if (bili >= 50) {\r\n            // 比例大于50的时候绿色是越来越少的,直到0 变为纯红\r\n            g = 255 - (bili - 50) * one;\r\n            r = 255;\r\n        }\r\n        r = parseInt(r, 10); // 取整\r\n        g = parseInt(g, 10); // 取整\r\n        b = parseInt(b, 10); // 取整\r\n        return `background-color:rgb(${r},${g},${b})`;\r\n    } else if (aqiVal >= 100) {\r\n        return 'background-color:red';\r\n    }\r\n    return undefined;\r\n};\r\n\r\nexport const getCurrentTime = () => {\r\n    return dayjs().format('YYYY-MM-DD HH:MM:ss');\r\n};\r\n\r\nexport const getLevelByMesure = ( mesure: number) => {\r\n    if (mesure <= 50) {\r\n        return {\r\n            color: '#07A872',\r\n            level: '优'\r\n        };\r\n    } else if (mesure <= 100) {\r\n        return {\r\n            color: '#F5BA18',\r\n            level: '良'\r\n        };\r\n    } else if (mesure <= 150) {\r\n        return {\r\n            color: '#F57E18',\r\n            level: '轻度污染'\r\n        };\r\n    } else if (mesure <= 200) {\r\n        return {\r\n            color: '#DA1811',\r\n            level: '中度污染'\r\n        };\r\n    } else if (mesure <= 300) {\r\n        return {\r\n            color: '#792BBB',\r\n            level: '重度污染'\r\n        };\r\n    } else if (mesure > 300) {\r\n        return {\r\n            color: '#A21A10',\r\n            level: '严重污染'\r\n        };\r\n    }\r\n};\r\n\r\n\r\n// 获取路径中的字段\r\nexport function GetQueryString(name: string): string | null {\r\n    // let allQuery = this.$route.query;\r\n    // return allQuery[name] ? allQuery[name] :null\r\n    const reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)');\r\n    const search = window.location.search ? window.location.search : `?${location.href.split('?')[1]}`;\r\n    const r = search.substr(1).match(reg);\r\n    if (r != null) {\r\n        return unescape(r[2]);\r\n    }\r\n    return null;\r\n}\r\n\r\n// 获取风向\r\nexport const getWindDirection = (num: number) => {\r\n    let result = '';\r\n    if(+num === 0 || +num === 360) {\r\n        result = '北风';\r\n    }else if (+num > 0 && +num < 90) {\r\n        result = '东北风';\r\n    }else if (+num === 90) {\r\n        result = '东风';\r\n    }else if (+num > 90 && +num < 180) {\r\n        result = '东南风';\r\n    }else if (+num === 180) {\r\n        result = '南风';\r\n    }else if (+num > 180 && +num < 270) {\r\n        result = '西南风';\r\n    }else if (+num === 270) {\r\n        result = '西风';\r\n    }else if (+num > 270 && +num < 269) {\r\n        result = '西北风';\r\n    }\r\n    return result;\r\n};\r\n\r\n\r\nexport const validateForm = (elForm: FormInstance) =>\r\n    new Promise((resolve, reject) => {\r\n        elForm.validate(valid => {\r\n            if (valid) {\r\n                resolve(valid);\r\n            } else {\r\n                reject();\r\n            }\r\n        });\r\n    });\r\n\r\n\r\nexport const getFlatArry = tree => {\r\n    const temp = [];\r\n    tree.map(el => {\r\n        temp.push(el.id);\r\n        if(el.children && el.children.length ) {\r\n            temp.push(...getFlatArry(el.children));\r\n        }\r\n    });\r\n    return temp;\r\n};\r\n\r\n\r\nexport const handleExport = async (url) => {\r\n    const elink = document.createElement('a');\r\n    elink.style.display = 'none';\r\n    elink.href = url;\r\n    document.body.appendChild(elink);\r\n    elink.click();\r\n    URL.revokeObjectURL(elink.href); // 释放URL 对象\r\n    document.body.removeChild(elink);\r\n\r\n}\r\n\r\n\r\nconst startPolling = () => {\r\n\r\n  };\r\n\r\n  // 停止轮询\r\nconst stopPolling = () => {\r\n\r\n};\r\nexport class Polling {\r\n    private pollingInterval: number | null = null;\r\n    private intervalTime: number;\r\n    private callback: (() => void) | null = null;\r\n\r\n    constructor(intervalTime: number, callback: () => void) {\r\n        this.intervalTime = intervalTime;\r\n        this.callback = callback;\r\n    }\r\n\r\n    /**\r\n     * 启动轮询\r\n     */\r\n    start(): void {\r\n        if (this.pollingInterval !== null) {\r\n            console.warn('轮询已在运行中，无需重复启动');\r\n            return;\r\n        }\r\n\r\n        if (typeof this.callback !== 'function') {\r\n            console.error('无法启动轮询：回调函数未定义');\r\n            return;\r\n        }\r\n\r\n        this.pollingInterval = window.setInterval(this.callback, this.intervalTime);\r\n    }\r\n\r\n    /**\r\n     * 停止轮询\r\n     */\r\n    stop(): void {\r\n        if (this.pollingInterval === null) {\r\n            return;\r\n        }\r\n\r\n        window.clearInterval(this.pollingInterval);\r\n        this.pollingInterval = null;\r\n    }\r\n\r\n    /**\r\n     * 销毁轮询器（适用于组件卸载等场景）\r\n     */\r\n    destroy(): void {\r\n        this.stop();\r\n        this.callback = null;\r\n    }\r\n\r\n    /**\r\n     * 动态更新轮询间隔时间\r\n     * @param newInterval 新的间隔时间（毫秒）\r\n     */\r\n    updateInterval(newInterval: number): void {\r\n        if (newInterval <= 0) {\r\n            console.error('间隔时间必须大于0毫秒');\r\n            return;\r\n        }\r\n\r\n        const wasRunning = this.pollingInterval !== null;\r\n        this.stop(); // 停止当前轮询\r\n        this.intervalTime = newInterval;\r\n\r\n        if (wasRunning) {\r\n            this.start(); // 如果之前是运行状态，则重新启动\r\n        }\r\n    }\r\n}\r\n"],"names":["validateForm","elForm","resolve","reject","valid","Polling","intervalTime","callback","newInterval","wasRunning"],"mappings":"wDAuHO,MAAMA,EAAgBC,GACzB,IAAI,QAAQ,CAACC,EAASC,IAAW,CAC7BF,EAAO,SAAkBG,GAAA,CACjBA,EACAF,EAAQE,CAAK,EAEND,GACX,CACH,CACL,CAAC,EAmCE,MAAME,CAAQ,CAKjB,YAAYC,EAAsBC,EAAsB,CAJxD,KAAQ,gBAAiC,KAEzC,KAAQ,SAAgC,KAGpC,KAAK,aAAeD,EACpB,KAAK,SAAWC,CACpB,CAKA,OAAc,CACN,GAAA,KAAK,kBAAoB,KAAM,CAC/B,QAAQ,KAAK,sFAAgB,EAC7B,MACJ,CAEI,GAAA,OAAO,KAAK,UAAa,WAAY,CACrC,QAAQ,MAAM,sFAAgB,EAC9B,MACJ,CAEA,KAAK,gBAAkB,OAAO,YAAY,KAAK,SAAU,KAAK,YAAY,CAC9E,CAKA,MAAa,CACL,KAAK,kBAAoB,OAItB,OAAA,cAAc,KAAK,eAAe,EACzC,KAAK,gBAAkB,KAC3B,CAKA,SAAgB,CACZ,KAAK,KAAK,EACV,KAAK,SAAW,IACpB,CAMA,eAAeC,EAA2B,CACtC,GAAIA,GAAe,EAAG,CAClB,QAAQ,MAAM,+DAAa,EAC3B,MACJ,CAEM,MAAAC,EAAa,KAAK,kBAAoB,KAC5C,KAAK,KAAK,EACV,KAAK,aAAeD,EAEhBC,GACA,KAAK,MAAM,CAEnB,CACJ"}